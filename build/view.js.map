{"version":3,"file":"view.js","mappings":"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","sources":["webpack://spacial-button/./src/view.js"],"sourcesContent":["const spacialContainers = document.querySelectorAll('.wp-block-spc-btn-spacial-button')\r\nlet windowScrollTopBase = window.scrollY\r\nlet mousePos = {\r\n    x:0,\r\n    y:0\r\n}\r\n\r\nfunction calculateContainerBox(container){\r\n    const containerBox = container.getBoundingClientRect()\r\n    const innerContainerBox = container.childNodes[1].getBoundingClientRect()\r\n\r\n    let values = {\r\n        outer:{\r\n            x:containerBox.x,\r\n            y:containerBox.y,\r\n            w:containerBox.width,\r\n            h:containerBox.height\r\n        },\r\n        inner:{\r\n            x:innerContainerBox.x,\r\n            y:innerContainerBox.y,\r\n            w:innerContainerBox.width,\r\n            h:innerContainerBox.height\r\n        }\r\n    }\r\n\r\n    return values\r\n}\r\n\r\nfunction calculateInnerBoxSize(container){\r\n    const containerBox = calculateContainerBox(container)\r\n    container.style.setProperty('--innerW', `${Math.round(containerBox.inner.w)}px`)\r\n    container.style.setProperty('--innerH', `${Math.round(containerBox.inner.h)}px`)\r\n}\r\n\r\nfunction calculateSpacialRel(container, event){\r\n    \r\n    const containerBox = calculateContainerBox(container)\r\n    const mX = event.x\r\n    const mY = event.y\r\n\r\n    const mRelX = mX - containerBox.outer.x\r\n    const mRelY = mY - containerBox.outer.y\r\n\r\n    let precision = 1000\r\n\r\n    let percentW = Math.floor((mRelX / containerBox.outer.w)*precision)/precision\r\n    let percentH = Math.floor((mRelY / containerBox.outer.h)*precision)/precision\r\n\r\n    let posX = Math.round(percentW * containerBox.outer.w)\r\n    let posY = Math.round(percentH * containerBox.outer.h)\r\n\r\n    container.style.setProperty('--posX', `${posX}px`)\r\n    container.style.setProperty('--posY', `${posY}px`)\r\n\r\n}\r\n\r\nfunction updatePosOnScroll(container, scrollAmount){\r\n    let containerStyles = window.getComputedStyle(container)\r\n    let containerPosYStyle = containerStyles.getPropertyValue('--posY')\r\n    let oldContainerY = parseInt(containerPosYStyle)\r\n\r\n    let newContainerY = Math.round(oldContainerY - scrollAmount)\r\n\r\n    container.style.setProperty('--posY', `${newContainerY}px`)\r\n    \r\n}\r\n\r\n\r\nwindow.onload = () =>{\r\n        spacialContainers.forEach((container)=>{\r\n\r\n            calculateInnerBoxSize(container)\r\n\r\n            if(container.classList.contains('is-local')){\r\n                container.addEventListener(\"mousemove\", (e)=>{\r\n                    calculateSpacialRel(container, e)\r\n                })\r\n            }\r\n        })\r\n}\r\n\r\nwindow.addEventListener('resize', ()=>{\r\n    spacialContainers.forEach((container)=>{\r\n        calculateInnerBoxSize(container)\r\n    }) \r\n})\r\n\r\n\r\n\r\n\r\n\r\nconst updateGlobalContainers = (e) =>{\r\n\r\n    mousePos.x = e.x\r\n    mousePos.y = e.y\r\n    console.log(mousePos)\r\n\r\n    visibleSpacial.forEach((container)=>{\r\n        if(container.classList.contains('is-global')){\r\n            calculateSpacialRel(container, mousePos)\r\n        }\r\n    })\r\n\r\n}\r\nfunction updateGlobalContainersOnScroll(e){\r\n    let newScrollTop = window.scrollY\r\n    let scrollAmount = windowScrollTopBase - newScrollTop\r\n    visibleSpacial.forEach((container=>{\r\n        if(container.classList.contains('is-global')){\r\n            updatePosOnScroll(container, scrollAmount)\r\n            calculateSpacialRel(container, mousePos)\r\n        }\r\n    }))\r\n    windowScrollTopBase = newScrollTop\r\n}\r\n\r\n\r\nlet visibleSpacial = []\r\n\r\nconst spacialObserver = new IntersectionObserver((entries)=>{\r\n    entries.forEach(entry=>{\r\n        if(entry.isIntersecting){\r\n            visibleSpacial.push(entry.target)\r\n        }else{\r\n            const index = visibleSpacial.indexOf(entry.target);\r\n            if (index !== -1) {\r\n                visibleSpacial.splice(index, 1);\r\n            }\r\n        }\r\n    })\r\n\r\n    if(visibleSpacial.length > 0){\r\n        window.addEventListener('mousemove', updateGlobalContainers)\r\n        window.addEventListener('scroll', updateGlobalContainersOnScroll)\r\n    }else if(visibleSpacial.length <= 0){\r\n        window.removeEventListener('mousemove', updateGlobalContainers)\r\n        window.removeEventListener('scroll', updateGlobalContainersOnScroll)\r\n    }\r\n}, {\r\n    threshold:0\r\n})\r\n\r\nspacialContainers.forEach((container)=>{\r\n    if(container.classList.contains('is-global')){\r\n        spacialObserver.observe(container)\r\n    }\r\n})"],"names":["spacialContainers","document","querySelectorAll","windowScrollTopBase","window","scrollY","mousePos","x","y","calculateContainerBox","container","containerBox","getBoundingClientRect","innerContainerBox","childNodes","values","outer","w","width","h","height","inner","calculateInnerBoxSize","style","setProperty","Math","round","calculateSpacialRel","event","mX","mY","mRelX","mRelY","precision","percentW","floor","percentH","posX","posY","updatePosOnScroll","scrollAmount","containerStyles","getComputedStyle","containerPosYStyle","getPropertyValue","oldContainerY","parseInt","newContainerY","onload","forEach","classList","contains","addEventListener","e","updateGlobalContainers","console","log","visibleSpacial","updateGlobalContainersOnScroll","newScrollTop","spacialObserver","IntersectionObserver","entries","entry","isIntersecting","push","target","index","indexOf","splice","length","removeEventListener","threshold","observe"],"sourceRoot":""}