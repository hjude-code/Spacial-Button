{"version":3,"file":"view.js","mappings":"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","sources":["webpack://spacial-button/./src/view.js"],"sourcesContent":["const spacialContainers = document.querySelectorAll('.wp-block-spc-btn-spacial-button')\r\nlet windowScrollTopBase = window.scrollY\r\nlet mousePos = {\r\n    x:0,\r\n    y:0\r\n}\r\n\r\nfunction setStickyTop(){\r\n    let header = document.querySelector('header')\r\n    let headerHeight = Math.round(header.getBoundingClientRect().height)\r\n\r\n    spacialContainers.forEach((container)=>{\r\n       container.style.setProperty('--stickyTop', `${headerHeight}px`)\r\n    })\r\n}\r\n\r\nfunction calculateContainerBox(container){\r\n    const containerBox = container.getBoundingClientRect()\r\n    const innerContainerBox = container.childNodes[1].getBoundingClientRect()\r\n\r\n    let values = {\r\n        outer:{\r\n            x:containerBox.x,\r\n            y:containerBox.y,\r\n            w:containerBox.width,\r\n            h:containerBox.height\r\n        },\r\n        inner:{\r\n            x:innerContainerBox.x,\r\n            y:innerContainerBox.y,\r\n            w:innerContainerBox.width,\r\n            h:innerContainerBox.height\r\n        }\r\n    }\r\n\r\n    return values\r\n}\r\n\r\nfunction calculateInnerBoxSize(container){\r\n    const containerBox = calculateContainerBox(container)\r\n    container.style.setProperty('--innerW', `${Math.round(containerBox.inner.w)}px`)\r\n    container.style.setProperty('--innerH', `${Math.round(containerBox.inner.h)}px`)\r\n}\r\n\r\nfunction calculateSpacialRel(container, event){\r\n    \r\n    const containerBox = calculateContainerBox(container)\r\n    const mX = event.x\r\n    const mY = event.y\r\n\r\n    const mRelX = mX - containerBox.outer.x\r\n    const mRelY = mY - containerBox.outer.y\r\n\r\n    let precision = 1000\r\n\r\n    let percentW = Math.floor((mRelX / containerBox.outer.w)*precision)/precision\r\n    let percentH = Math.floor((mRelY / containerBox.outer.h)*precision)/precision\r\n\r\n    let posX = Math.round(percentW * containerBox.outer.w)\r\n    let posY = Math.round(percentH * containerBox.outer.h)\r\n\r\n    container.style.setProperty('--posX', `${posX}px`)\r\n    container.style.setProperty('--posY', `${posY}px`)\r\n\r\n}\r\n\r\nfunction updatePosOnScroll(container, scrollAmount){\r\n    let containerStyles = window.getComputedStyle(container)\r\n    let containerPosYStyle = containerStyles.getPropertyValue('--posY')\r\n    let oldContainerY = parseInt(containerPosYStyle)\r\n\r\n    let newContainerY = Math.round(oldContainerY - scrollAmount)\r\n\r\n    container.style.setProperty('--posY', `${newContainerY}px`)\r\n    \r\n}\r\n\r\n\r\nwindow.onload = () =>{\r\n        spacialContainers.forEach((container)=>{\r\n\r\n            calculateInnerBoxSize(container)\r\n\r\n            if(container.classList.contains('is-local')){\r\n                container.addEventListener(\"mousemove\", (e)=>{\r\n                    calculateSpacialRel(container, e)\r\n                })\r\n            }\r\n        })\r\n\r\n        setStickyTop()\r\n}\r\n\r\nwindow.addEventListener('resize', ()=>{\r\n    spacialContainers.forEach((container)=>{\r\n        calculateInnerBoxSize(container)\r\n    }) \r\n\r\n    setStickyTop()\r\n})\r\n\r\n\r\n\r\n\r\n\r\nconst updateGlobalContainers = (e) =>{\r\n\r\n    mousePos.x = e.x\r\n    mousePos.y = e.y\r\n\r\n    visibleSpacial.forEach((container)=>{\r\n        if(container.classList.contains('is-global')){\r\n            calculateSpacialRel(container, mousePos)\r\n        }\r\n    })\r\n\r\n}\r\nfunction updateGlobalContainersOnScroll(e){\r\n    let newScrollTop = window.scrollY\r\n    let scrollAmount = windowScrollTopBase - newScrollTop\r\n    visibleSpacial.forEach((container=>{\r\n        if(container.classList.contains('is-global')){\r\n            updatePosOnScroll(container, scrollAmount)\r\n            calculateSpacialRel(container, mousePos)\r\n        }\r\n    }))\r\n    windowScrollTopBase = newScrollTop\r\n}\r\n\r\n\r\nlet visibleSpacial = []\r\n\r\nconst spacialObserver = new IntersectionObserver((entries)=>{\r\n    entries.forEach(entry=>{\r\n        if(entry.isIntersecting){\r\n            visibleSpacial.push(entry.target)\r\n        }else{\r\n            const index = visibleSpacial.indexOf(entry.target);\r\n            if (index !== -1) {\r\n                visibleSpacial.splice(index, 1);\r\n            }\r\n        }\r\n    })\r\n\r\n    if(visibleSpacial.length > 0){\r\n        window.addEventListener('mousemove', updateGlobalContainers)\r\n        window.addEventListener('scroll', updateGlobalContainersOnScroll)\r\n    }else if(visibleSpacial.length <= 0){\r\n        window.removeEventListener('mousemove', updateGlobalContainers)\r\n        window.removeEventListener('scroll', updateGlobalContainersOnScroll)\r\n    }\r\n\r\n}, {\r\n    threshold:0\r\n})\r\n\r\nspacialContainers.forEach((container)=>{\r\n    if(container.classList.contains('is-global')){\r\n        spacialObserver.observe(container)\r\n    }\r\n})"],"names":["spacialContainers","document","querySelectorAll","windowScrollTopBase","window","scrollY","mousePos","x","y","setStickyTop","header","querySelector","headerHeight","Math","round","getBoundingClientRect","height","forEach","container","style","setProperty","calculateContainerBox","containerBox","innerContainerBox","childNodes","values","outer","w","width","h","inner","calculateInnerBoxSize","calculateSpacialRel","event","mX","mY","mRelX","mRelY","precision","percentW","floor","percentH","posX","posY","updatePosOnScroll","scrollAmount","containerStyles","getComputedStyle","containerPosYStyle","getPropertyValue","oldContainerY","parseInt","newContainerY","onload","classList","contains","addEventListener","e","updateGlobalContainers","visibleSpacial","updateGlobalContainersOnScroll","newScrollTop","spacialObserver","IntersectionObserver","entries","entry","isIntersecting","push","target","index","indexOf","splice","length","removeEventListener","threshold","observe"],"sourceRoot":""}